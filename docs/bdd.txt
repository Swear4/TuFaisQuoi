aussi, voici a quoi reesemble ma base de donnÃ©e pour linstant, juste pour te la donner et tassurer que le schema fasse du sens :

-- WARNING: This schema is for context only and is not meant to be run.
-- Table order and constraints may not be valid for execution.

CREATE TABLE public.carpool_passengers (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  carpool_id uuid NOT NULL,
  user_id uuid NOT NULL,
  seats_reserved integer NOT NULL DEFAULT 1 CHECK (seats_reserved > 0),
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT carpool_passengers_pkey PRIMARY KEY (id),
  CONSTRAINT carpool_passengers_carpool_id_fkey FOREIGN KEY (carpool_id) REFERENCES public.carpools(id),
  CONSTRAINT carpool_passengers_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(id)
);
CREATE TABLE public.carpools (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  event_id uuid,
  driver_id uuid,
  departure_location text NOT NULL,
  departure_time timestamp with time zone NOT NULL,
  available_seats integer NOT NULL CHECK (available_seats > 0),
  price_per_seat numeric,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT carpools_pkey PRIMARY KEY (id),
  CONSTRAINT carpools_event_id_fkey FOREIGN KEY (event_id) REFERENCES public.events(id),
  CONSTRAINT carpools_driver_id_fkey FOREIGN KEY (driver_id) REFERENCES public.users(id)
);
CREATE TABLE public.event_favorites (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  user_id uuid NOT NULL,
  event_id uuid NOT NULL,
  created_at timestamp with time zone NOT NULL DEFAULT now(),
  CONSTRAINT event_favorites_pkey PRIMARY KEY (id),
  CONSTRAINT event_favorites_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id),
  CONSTRAINT event_favorites_event_id_fkey FOREIGN KEY (event_id) REFERENCES public.events(id)
);
CREATE TABLE public.event_registrations (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  event_id uuid,
  user_id uuid,
  carpool_id uuid,
  before_after_id uuid,
  ticket_type text DEFAULT 'standard'::text,
  is_refundable boolean DEFAULT true,
  registration_date timestamp with time zone DEFAULT now(),
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT event_registrations_pkey PRIMARY KEY (id),
  CONSTRAINT event_registrations_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(id),
  CONSTRAINT event_registrations_carpool_id_fkey FOREIGN KEY (carpool_id) REFERENCES public.carpools(id),
  CONSTRAINT event_registrations_event_id_fkey FOREIGN KEY (event_id) REFERENCES public.events(id)
);
CREATE TABLE public.events (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  title text NOT NULL,
  description text,
  date timestamp with time zone NOT NULL,
  location text NOT NULL,
  category text NOT NULL CHECK (category = ANY (ARRAY['culturel'::text, 'concert'::text, 'sport'::text, 'nature'::text, 'gastronomie'::text, 'festival'::text, 'nocturne'::text, 'famille'::text, 'bien-etre'::text, 'shopping'::text])),
  capacity integer CHECK (capacity > 0),
  image_url text,
  is_premium_only boolean DEFAULT false,
  organizer_id uuid,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  participants_count integer NOT NULL DEFAULT 0,
  latitude double precision,
  longitude double precision,
  is_hidden boolean NOT NULL DEFAULT false,
  favorites_count integer NOT NULL DEFAULT 0,
  CONSTRAINT events_pkey PRIMARY KEY (id),
  CONSTRAINT events_organizer_id_fkey FOREIGN KEY (organizer_id) REFERENCES public.users(id)
);
CREATE TABLE public.messages (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  event_id uuid NOT NULL,
  user_id uuid NOT NULL,
  content text NOT NULL CHECK (length(content) > 0),
  created_at timestamp with time zone NOT NULL DEFAULT timezone('utc'::text, now()),
  CONSTRAINT messages_pkey PRIMARY KEY (id),
  CONSTRAINT messages_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id),
  CONSTRAINT messages_event_id_fkey FOREIGN KEY (event_id) REFERENCES public.events(id)
);
CREATE TABLE public.trip_bookings (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  trip_id uuid,
  user_id uuid,
  option_id uuid,
  booking_date timestamp with time zone DEFAULT now(),
  status text DEFAULT 'pending'::text CHECK (status = ANY (ARRAY['pending'::text, 'confirmed'::text, 'cancelled'::text])),
  CONSTRAINT trip_bookings_pkey PRIMARY KEY (id),
  CONSTRAINT trip_bookings_trip_id_fkey FOREIGN KEY (trip_id) REFERENCES public.trips(id),
  CONSTRAINT trip_bookings_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(id),
  CONSTRAINT trip_bookings_option_id_fkey FOREIGN KEY (option_id) REFERENCES public.trip_options(id)
);
CREATE TABLE public.trip_options (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  trip_id uuid,
  name text NOT NULL,
  price numeric NOT NULL,
  features jsonb NOT NULL,
  available_spots integer,
  created_at timestamp with time zone DEFAULT now(),
  CONSTRAINT trip_options_pkey PRIMARY KEY (id),
  CONSTRAINT trip_options_trip_id_fkey FOREIGN KEY (trip_id) REFERENCES public.trips(id)
);
CREATE TABLE public.trips (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  title text NOT NULL,
  description text,
  location text NOT NULL,
  start_date date NOT NULL,
  end_date date NOT NULL,
  duration text NOT NULL,
  image_url text,
  min_price numeric NOT NULL,
  max_price numeric NOT NULL,
  is_published boolean DEFAULT false,
  created_by uuid,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT trips_pkey PRIMARY KEY (id),
  CONSTRAINT trips_created_by_fkey FOREIGN KEY (created_by) REFERENCES public.users(id)
);
CREATE TABLE public.users (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  email text NOT NULL UNIQUE,
  name text NOT NULL,
  avatar_url text,
  subscription_type text DEFAULT 'free'::text CHECK (subscription_type = ANY (ARRAY['free'::text, 'premium'::text, 'premium_plus'::text])),
  is_professional boolean DEFAULT false,
  is_verified boolean DEFAULT false,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT users_pkey PRIMARY KEY (id)
);